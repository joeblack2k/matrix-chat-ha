send_message:
  name: Send Matrix message
  description: Send a text message to Matrix rooms and/or users (direct messages).
  fields:
    entry_id:
      name: Integration entry
      description: Optional config entry ID when multiple Matrix Chat entries exist.
      example: 01JXYZABCDEF
      selector:
        text:
    target:
      name: Target
      description: Single target, for example !roomid:server, #alias:server or @user:server.
      example: "@user:matrix.example.org"
      selector:
        text:
    targets:
      name: Targets
      description: List of targets, each !roomid:server, #alias:server or @user:server.
      example:
        - "@user:matrix.example.org"
        - "!abc123def456:matrix.example.org"
      selector:
        object:
    message:
      name: Message
      description: Message body to send.
      required: true
      selector:
        text:
    format:
      name: Format
      description: Message format.
      default: text
      selector:
        select:
          options:
            - text
            - html
    reply_to_event_id:
      name: Reply to event ID
      description: Optional Matrix event ID to send this message as a reply.
      example: "$abc123def456:matrix.example.org"
      selector:
        text:
    edit_event_id:
      name: Edit event ID
      description: Optional Matrix event ID to edit (m.replace). Mutually exclusive with reply_to_event_id.
      example: "$abc123def456:matrix.example.org"
      selector:
        text:

send_media:
  name: Send Matrix media
  description: Send an image, video, or file to Matrix rooms and/or users (direct messages).
  fields:
    entry_id:
      name: Integration entry
      description: Optional config entry ID when multiple Matrix Chat entries exist.
      example: 01JXYZABCDEF
      selector:
        text:
    target:
      name: Target
      description: Single target, for example !roomid:server, #alias:server or @user:server.
      example: "@user:matrix.example.org"
      selector:
        text:
    targets:
      name: Targets
      description: List of targets, each !roomid:server, #alias:server or @user:server.
      example:
        - "@user:matrix.example.org"
      selector:
        object:
    file_path:
      name: File path
      description: Absolute file path on Home Assistant host, e.g. /config/www/photo.jpg.
      required: true
      selector:
        text:
    message:
      name: Caption
      description: Optional caption/body shown with media.
      selector:
        text:
    mime_type:
      name: MIME type
      description: Optional override; auto-detected if omitted.
      selector:
        text:
    auto_convert:
      name: Auto-convert video
      description: Convert large videos to MP4 (H.264/AAC) for better compatibility.
      default: true
      selector:
        boolean:
    convert_threshold_mb:
      name: Convert threshold (MB)
      description: Convert videos larger than this size.
      default: 20
      selector:
        number:
          min: 1
          max: 1024
          mode: box
    max_size_mb:
      name: Max upload size (MB)
      description: Service-level max file size before upload.
      default: 200
      selector:
        number:
          min: 1
          max: 4096
          mode: box

send_reaction:
  name: Send Matrix reaction
  description: Send a reaction (emoji/key) to an existing Matrix event.
  fields:
    entry_id:
      name: Integration entry
      description: Optional config entry ID when multiple Matrix Chat entries exist.
      example: 01JXYZABCDEF
      selector:
        text:
    target:
      name: Target
      description: Single target room or user, for example !roomid:server, #alias:server or @user:server.
      example: "@user:matrix.example.org"
      selector:
        text:
    targets:
      name: Targets
      description: List of targets, each !roomid:server, #alias:server or @user:server.
      example:
        - "@user:matrix.example.org"
      selector:
        object:
    event_id:
      name: Event ID
      description: Matrix event ID to react to.
      required: true
      example: "$abc123def456:matrix.example.org"
      selector:
        text:
    reaction_key:
      name: Reaction key
      description: Emoji or key used as reaction.
      required: true
      example: "üëç"
      selector:
        text:

get_inbound_config:
  name: Get inbound config
  description: Return inbound webhook details and event type for this Matrix Chat entry.
  fields:
    entry_id:
      name: Integration entry
      description: Optional config entry ID when multiple Matrix Chat entries exist.
      example: 01JXYZABCDEF
      selector:
        text:

get_outbox_stats:
  name: Get outbox stats
  description: Return queued outbound retry stats (when Matrix or the encrypted gateway was temporarily unreachable).
  fields:
    entry_id:
      name: Integration entry
      description: Optional config entry ID when multiple Matrix Chat entries exist.
      example: 01JXYZABCDEF
      selector:
        text:

flush_outbox:
  name: Flush outbox
  description: Try sending queued outbound messages/media now (best-effort).
  fields:
    entry_id:
      name: Integration entry
      description: Optional config entry ID when multiple Matrix Chat entries exist.
      example: 01JXYZABCDEF
      selector:
        text:
    max_items:
      name: Max items
      description: Maximum number of queued items to attempt this flush.
      default: 25
      selector:
        number:
          min: 1
          max: 500
          mode: box

resolve_target:
  name: Resolve target
  description: Resolve a Matrix target (@user, !room_id, #alias) to a concrete room_id and show whether the room is encrypted.
  fields:
    entry_id:
      name: Integration entry
      description: Optional config entry ID when multiple Matrix Chat entries exist.
      example: 01JXYZABCDEF
      selector:
        text:
    target:
      name: Target
      description: Target to resolve.
      required: true
      example: "@user:matrix.example.org"
      selector:
        text:

list_rooms:
  name: List joined rooms
  description: List rooms the bot account is currently joined to (best-effort).
  fields:
    entry_id:
      name: Integration entry
      description: Optional config entry ID when multiple Matrix Chat entries exist.
      example: 01JXYZABCDEF
      selector:
        text:
    limit:
      name: Limit
      description: Maximum number of rooms to return.
      default: 50
      selector:
        number:
          min: 1
          max: 500
          mode: box
    include_members:
      name: Include members
      description: Include joined member MXIDs for each room (more API calls).
      default: false
      selector:
        boolean:

join_room:
  name: Join room
  description: Have the bot join a room by room ID or alias.
  fields:
    entry_id:
      name: Integration entry
      description: Optional config entry ID when multiple Matrix Chat entries exist.
      example: 01JXYZABCDEF
      selector:
        text:
    room_or_alias:
      name: Room ID or alias
      description: Room ID (!room:server) or alias (#alias:server) to join.
      required: true
      example: "#huisje:chat.patatje.net"
      selector:
        text:

invite_user:
  name: Invite user
  description: Invite a Matrix user to a room (bot must have permission).
  fields:
    entry_id:
      name: Integration entry
      description: Optional config entry ID when multiple Matrix Chat entries exist.
      example: 01JXYZABCDEF
      selector:
        text:
    room_id:
      name: Room ID
      description: Room ID to invite into.
      required: true
      example: "!abc123def456:matrix.example.org"
      selector:
        text:
    user_id:
      name: User ID
      description: Matrix user ID to invite.
      required: true
      example: "@user:matrix.example.org"
      selector:
        text:
    dry_run:
      name: Dry-run
      description: Validate inputs but do not send the invite (recommended for testing).
      default: false
      selector:
        boolean:

ensure_dm:
  name: Ensure DM
  description: Ensure a direct-message room exists with a user and return its room ID.
  fields:
    entry_id:
      name: Integration entry
      description: Optional config entry ID when multiple Matrix Chat entries exist.
      example: 01JXYZABCDEF
      selector:
        text:
    user_id:
      name: User ID
      description: Matrix user ID to DM (will create a DM if needed).
      required: true
      example: "@user:matrix.example.org"
      selector:
        text:

ensure_room_encrypted:
  name: Ensure room encrypted
  description: Enable E2EE in an existing room (one-way operation). Returns whether room is encrypted.
  fields:
    entry_id:
      name: Integration entry
      description: Optional config entry ID when multiple Matrix Chat entries exist.
      example: 01JXYZABCDEF
      selector:
        text:
    room_id:
      name: Room ID
      description: Room ID to encrypt.
      required: true
      example: "!abc123def456:matrix.example.org"
      selector:
        text:
